import streamlit as st
import pandas as pd
import numpy as np

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
st.set_page_config(
    page_title="–≠–∫—Å–ø–µ—Ä—Ç–Ω–∞—è –æ—Ü–µ–Ω–∫–∞ –ø—Ä–æ–µ–∫—Ç–æ–≤",
    page_icon="üè¢",
    layout="wide",
    initial_sidebar_state="collapsed"
)


def main():
    # –ó–∞–≥–æ–ª–æ–≤–æ–∫
    st.title('–≠–∫—Å–ø–µ—Ä—Ç–Ω–∞—è –æ—Ü–µ–Ω–∫–∞ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ —Å—Ç—Ä–æ–∏—Ç–µ–ª—å—Å—Ç–≤–∞ —Ç–æ—Ä–≥–æ–≤–æ–≥–æ —Ü–µ–Ω—Ç—Ä–∞')
    st.info("""
    –£–≤–∞–∂–∞–µ–º—ã–π —ç–∫—Å–ø–µ—Ä—Ç! –ü—Ä–æ—Å–∏–º –í–∞—Å –ø–æ–ø–∞—Ä–Ω–æ —Å—Ä–∞–≤–Ω–∏—Ç—å –≤–∞—Ä–∏–∞–Ω—Ç—ã —Å—Ç—Ä–æ–∏—Ç–µ–ª—å—Å—Ç–≤–∞ —Ç–æ—Ä–≥–æ–≤–æ–≥–æ —Ü–µ–Ω—Ç—Ä–∞ 
    –∏ –æ—Ü–µ–Ω–∏—Ç—å, –Ω–∞—Å–∫–æ–ª—å–∫–æ –æ–¥–∏–Ω –≤–∞—Ä–∏–∞–Ω—Ç –ø—Ä–µ–¥–ø–æ—á—Ç–∏—Ç–µ–ª—å–Ω–µ–µ –¥—Ä—É–≥–æ–≥–æ.
    """)

    # –û–ø—Ä–µ–¥–µ–ª—è–µ–º –≤–∞—Ä–∏–∞–Ω—Ç—ã
    options = [
        '–î–æ—Å—Ç—Ä–æ–π–∫–∞ –æ–¥–Ω–æ—ç—Ç–∞–∂–Ω–æ–≥–æ –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º–æ–≥–æ –ø–æ–º–µ—â–µ–Ω–∏—è –≤ —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ–º —Ä–∞–π–æ–Ω–µ –≥–æ—Ä–æ–¥–∞',
        '–°—Ç—Ä–æ–∏—Ç–µ–ª—å—Å—Ç–≤–æ –Ω–æ–≤–æ–≥–æ —Å—É–ø–µ—Ä–º–∞—Ä–∫–µ—Ç–∞, —Ç—Ä–µ–±—É—é—â–µ–µ –∫—Ä—É–ø–Ω—ã—Ö –∫–∞–ø–∏—Ç–∞–ª–æ–≤–ª–æ–∂–µ–Ω–∏–π, —Å –≤—ã–≥–æ–¥–Ω—ã–º —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ–º',
        '–°—Ç—Ä–æ–∏—Ç–µ–ª—å—Å—Ç–≤–æ —Å—É–ø–µ—Ä–º–∞—Ä–∫–µ—Ç–∞ –∑–∞ —á–µ—Ä—Ç–æ–π –≥–æ—Ä–æ–¥–∞ —Å –Ω–µ–±–æ–ª—å—à–∏–º–∏ –∑–∞—Ç—Ä–∞—Ç–∞–º–∏',
        '–°—Ç—Ä–æ–∏—Ç–µ–ª—å—Å—Ç–≤–æ —Ç–æ—Ä–≥–æ–≤–æ–≥–æ —Ü–µ–Ω—Ç—Ä–∞ –Ω–∞ –æ–∫—Ä–∞–∏–Ω–µ –≥–æ—Ä–æ–¥–∞ (—Ä–∞–π–æ–Ω –æ—Å–Ω–∞—â–µ–Ω —Ä–∞–∑–≤–∏—Ç–æ–π —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω–æ–π —Å–µ—Ç—å—é –∏ –ø–∞—Ä–∫–∏–Ω–≥–æ–º)'
    ]

    # –°–æ–∑–¥–∞–µ–º DataFrame –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è
    df = pd.DataFrame({'–í–∞—Ä–∏–∞–Ω—Ç—ã —Å—Ç—Ä–æ–∏—Ç–µ–ª—å—Å—Ç–≤–∞': options})
    df.index = np.arange(1, len(df) + 1)
    st.table(df)

    # –í–≤–æ–¥ –§–ò–û
    st.markdown('---')
    st.markdown('**–ü—Ä–µ–∂–¥–µ –≤—Å–µ–≥–æ, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ —Å–≤–æ–µ –§–ò–û:**')
    name = st.text_input("–§–ò–û —ç–∫—Å–ø–µ—Ä—Ç–∞", placeholder="–í–≤–µ–¥–∏—Ç–µ –≤–∞—à–µ –ø–æ–ª–Ω–æ–µ –∏–º—è", label_visibility="collapsed")

    # –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –¥–ª—è —ç–∫—Å–ø–µ—Ä—Ç–∞
    st.markdown('---')
    st.header('–ü–æ–ø–∞—Ä–Ω–æ–µ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤')

    st.success("""
    **–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è:** 
    –î–ª—è –∫–∞–∂–¥–æ–π –ø–∞—Ä—ã –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–∏—Ç–µ 15 –±–∞–ª–ª–æ–≤ –º–µ–∂–¥—É –Ω–∏–º–∏ –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å —Ç–µ–º, 
    –Ω–∞—Å–∫–æ–ª—å–∫–æ –æ–¥–∏–Ω –≤–∞—Ä–∏–∞–Ω—Ç –ø—Ä–µ–¥–ø–æ—á—Ç–∏—Ç–µ–ª—å–Ω–µ–µ –¥—Ä—É–≥–æ–≥–æ. 

    **–ü—Ä–∏–º–µ—Ä:**
    - –ï—Å–ª–∏ –≤–∞—Ä–∏–∞–Ω—Ç A –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ –ª—É—á—à–µ –≤–∞—Ä–∏–∞–Ω—Ç–∞ B ‚Üí A: 12 –±–∞–ª–ª–æ–≤, B: 3 –±–∞–ª–ª–∞
    - –ï—Å–ª–∏ –≤–∞—Ä–∏–∞–Ω—Ç—ã –ø—Ä–∏–º–µ—Ä–Ω–æ —Ä–∞–≤–Ω—ã ‚Üí A: 8 –±–∞–ª–ª–æ–≤, B: 7 –±–∞–ª–ª–æ–≤  
    - –ï—Å–ª–∏ –≤–∞—Ä–∏–∞–Ω—Ç A –Ω–µ–º–Ω–æ–≥–æ –ª—É—á—à–µ –≤–∞—Ä–∏–∞–Ω—Ç–∞ B ‚Üí A: 9 –±–∞–ª–ª–æ–≤, B: 6 –±–∞–ª–ª–æ–≤

    **–û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –±–∞–ª–ª–æ–≤ –¥–ª—è –∫–∞–∂–¥–æ–π –ø–∞—Ä—ã –¥–æ–ª–∂–Ω–æ —Ä–∞–≤–Ω—è—Ç—å—Å—è 15.**
    """)

    # –°–æ–∑–¥–∞–µ–º —Å–ª–æ–≤–∞—Ä—å –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –æ—Ü–µ–Ω–æ–∫
    scores = {}

    # –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –≤—Å–µ —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –ø–∞—Ä—ã –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤
    for i in range(len(options)):
        for j in range(i + 1, len(options)):
            option_a = options[i]
            option_b = options[j]

            st.markdown(f'### –°—Ä–∞–≤–Ω–µ–Ω–∏–µ: **–í–∞—Ä–∏–∞–Ω—Ç {i + 1}** vs **–í–∞—Ä–∏–∞–Ω—Ç {j + 1}**')

            # –ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –¥–ª—è —É–¥–æ–±—Å—Ç–≤–∞
            col_desc1, col_desc2 = st.columns(2)
            with col_desc1:
                st.caption(f"**–í–∞—Ä–∏–∞–Ω—Ç {i + 1}:** {option_a}")
            with col_desc2:
                st.caption(f"**–í–∞—Ä–∏–∞–Ω—Ç {j + 1}:** {option_b}")

            # –°–æ–∑–¥–∞–µ–º –¥–≤–∞ —Å—Ç–æ–ª–±—Ü–∞ –¥–ª—è —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –±–∞–ª–ª–æ–≤
            col1, col2 = st.columns([2, 2])

            with col1:
                st.markdown(f"**–ë–∞–ª–ª—ã –¥–ª—è –í–∞—Ä–∏–∞–Ω—Ç–∞ {i + 1}:**")
                score_a = st.slider(
                    f"–ë–∞–ª–ª—ã –¥–ª—è –≤–∞—Ä–∏–∞–Ω—Ç–∞ {i + 1}",
                    min_value=0,
                    max_value=15,
                    value=7,
                    key=f'{i}_{j}_a',
                    help=f"–°–∫–æ–ª—å–∫–æ –±–∞–ª–ª–æ–≤ –ø—Ä–∏—Å–≤–æ–∏—Ç—å –≤–∞—Ä–∏–∞–Ω—Ç—É '{option_a[:50]}...'?"
                )

            with col2:
                st.markdown(f"**–ë–∞–ª–ª—ã –¥–ª—è –í–∞—Ä–∏–∞–Ω—Ç–∞ {j + 1}:**")
                score_b = st.slider(
                    f"–ë–∞–ª–ª—ã –¥–ª—è –≤–∞—Ä–∏–∞–Ω—Ç–∞ {j + 1}",
                    min_value=0,
                    max_value=15,
                    value=8,
                    key=f'{i}_{j}_b',
                    help=f"–°–∫–æ–ª—å–∫–æ –±–∞–ª–ª–æ–≤ –ø—Ä–∏—Å–≤–æ–∏—Ç—å –≤–∞—Ä–∏–∞–Ω—Ç—É '{option_b[:50]}...'?"
                )


            st.markdown("**–ü—Ä–æ–≤–µ—Ä–∫–∞:**")
            total = score_a + score_b
            if total == 15:
                st.success("–°—É–º–º–∞: 15")
            else:
                st.error(f"–°—É–º–º–∞: {total}")
                st.warning("–°—É–º–º–∞ –±–∞–ª–ª–æ–≤ –¥–æ–ª–∂–Ω–∞ —Ä–∞–≤–Ω—è—Ç—å—Å—è 15!")

            # –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è
            st.markdown("**–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –±–∞–ª–ª–æ–≤:**")
            col_prog1, col_prog2 = st.columns(2)

            with col_prog1:
                st.metric(f"–í–∞—Ä–∏–∞–Ω—Ç {i + 1}", f"{score_a} –±–∞–ª–ª–æ–≤")
                st.progress(score_a / 15)

            with col_prog2:
                st.metric(f"–í–∞—Ä–∏–∞–Ω—Ç {j + 1}", f"{score_b} –±–∞–ª–ª–æ–≤")
                st.progress(score_b / 15)

            # –°–æ—Ö—Ä–∞–Ω—è–µ–º –æ—Ü–µ–Ω–∫–∏
            scores[f'{i}_{j}_a'] = score_a
            scores[f'{i}_{j}_b'] = score_b

            st.markdown('---')

    # –ö–Ω–æ–ø–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π
    st.markdown('### –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ –æ—Ü–µ–Ω–∫–∏')

    if st.button("üì§ –û—Ç–ø—Ä–∞–≤–∏—Ç—å —ç–∫—Å–ø–µ—Ä—Ç–Ω—É—é –æ—Ü–µ–Ω–∫—É", type="primary", use_container_width=True):
        if not name.strip():
            st.error("–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ –≤–∞—à–µ –§–ò–û –ø–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π.")
        else:
            # –ü—Ä–æ–≤–µ—Ä—è–µ–º –≤—Å–µ —Å—É–º–º—ã
            all_valid = True
            error_pairs = []

            for i in range(len(options)):
                for j in range(i + 1, len(options)):
                    total = scores[f'{i}_{j}_a'] + scores[f'{i}_{j}_b']
                    if total != 15:
                        all_valid = False
                        error_pairs.append(f"–í–∞—Ä–∏–∞–Ω—Ç—ã {i + 1} –∏ {j + 1} (—Å—É–º–º–∞: {total})")

            if not all_valid:
                st.error("–ù–µ –≤—Å–µ –ø–∞—Ä—ã –∏–º–µ—é—Ç —Å—É–º–º—É –±–∞–ª–ª–æ–≤ —Ä–∞–≤–Ω—É—é 15!")
                st.write("**–û—à–∏–±–∫–∏ –≤ –ø–∞—Ä–∞—Ö:**")
                for pair in error_pairs:
                    st.write(f"- {pair}")
                st.warning("–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∏—Å–ø—Ä–∞–≤—å—Ç–µ –æ—Ç–º–µ—á–µ–Ω–Ω—ã–µ –ø–∞—Ä—ã –ø–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π.")
            else:
                # –í—Å–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–æ–π–¥–µ–Ω—ã
                st.success(f'–ë–æ–ª—å—à–æ–µ —Å–ø–∞—Å–∏–±–æ, {name}! –í–∞—à–∞ —ç–∫—Å–ø–µ—Ä—Ç–Ω–∞—è –æ—Ü–µ–Ω–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞.')


if __name__ == "__main__":
    main()